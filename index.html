<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SciGrid 20M Excel Pro</title>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            background: #0a0a0b;
            font-family: 'Inter', sans-serif;
        }

        #grid-container {
            width: 100vw;
            height: 100vh;
        }

        /* Custom Scrollbar Styling */
        #grid-container::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        #grid-container::-webkit-scrollbar-track {
            background: #0a0a0b;
        }

        #grid-container::-webkit-scrollbar-thumb {
            background: #2a2a2e;
            border-radius: 6px;
            border: 3px solid #0a0a0b;
        }

        #grid-container::-webkit-scrollbar-thumb:hover {
            background: #4facfe;
        }

        #overlay {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(18, 18, 20, 0.85);
            backdrop-filter: blur(10px);
            color: #fff;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 100;
        }

        h1 {
            margin: 0 0 10px 0;
            font-size: 18px;
            color: #4facfe;
        }

        .stat {
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .tip {
            font-size: 12px;
            color: #aaa;
            margin-top: 10px;
            font-style: italic;
        }
    </style>
</head>

<body>
    <div id="grid-container"></div>
    <div id="overlay">
        <h1>SciGrid Excel Pro</h1>
        <div class="stat">Cells: 20,000,000</div>
        <div class="stat">Memory: Float64Array Ready</div>
        <div class="tip">Tip: Double-click to edit cell</div>
        <div class="tip">Tip: Click row # or Col ID to select</div>
        <button id="theme-btn"
            style="margin-top: 15px; padding: 8px 16px; background: #4facfe; border: none; border-radius: 6px; color: white; cursor: pointer; font-family: inherit; pointer-events: auto;">Switch
            to Light Mode</button>
    </div>

    <script type="module">
        import { SciGrid } from './src/sci-grid.ts';

        class ExcelDataProvider {
            constructor(rows, cols) {
                this.rows = rows;
                this.cols = cols;
                this.data = new Float64Array(rows * cols);
                for (let i = 0; i < this.data.length; i++) {
                    this.data[i] = Math.floor(Math.random() * 10000) / 100;
                }
            }

            getRowCount() { return this.rows; }
            getColumnCount() { return this.cols; }
            getCellData(row, col) {
                return this.data[row * this.cols + col];
            }
            setCellData(row, col, value) {
                const numericValue = parseFloat(value);
                if (!isNaN(numericValue)) {
                    this.data[row * this.cols + col] = numericValue;
                }
            }
            getHeader(col) {
                if (col === 0) return { name: "ID", variant: 'numeric', description: "Auto-inc" };
                if (col === 1) return { name: "TIME", units: "s", description: "Primary time axis", variant: 'numeric' };
                if (col === 2) return { name: "SIGNAL", units: "V", description: "Sensor A reading", variant: 'numeric' };
                
                let label = "";
                let n = col;
                while (n >= 0) {
                    label = String.fromCharCode((n % 26) + 65) + label;
                    n = Math.floor(n / 26) - 1;
                }
                return { name: label };
            }

            setHeader(col, header) {
                console.log(`Column ${col} header updated to:`, header);
            }
        }

        const container = document.getElementById('grid-container');
        const provider = new ExcelDataProvider(1000000, 20);

        const darkConfig = {
            backgroundColor: '#0a0a0b',
            gridLineColor: '#1e1e20',
            textColor: '#94a3b8',
            font: '13px "JetBrains Mono", monospace',
            headerBackground: '#121214',
            headerTextColor: '#4facfe',
            headerFont: 'bold 12px "Inter", sans-serif',
            rowNumberBackground: '#121214',
            rowNumberTextColor: '#666666',
            selectionColor: 'rgba(79, 172, 254, 0.2)',
            selectedTextColor: '#ffffff',
            alternateRowColor: '#0c0c0e',
        };

        const lightConfig = {
            backgroundColor: '#ffffff',
            gridLineColor: '#e2e8f0',
            textColor: '#334155',
            font: '13px "JetBrains Mono", monospace',
            headerBackground: '#f8fafc',
            headerTextColor: '#0f172a',
            headerFont: 'bold 12px "Inter", sans-serif',
            rowNumberBackground: '#f1f5f9',
            rowNumberTextColor: '#64748b',
            selectionColor: 'rgba(59, 130, 246, 0.2)',
            selectedTextColor: '#000000',
            alternateRowColor: '#f8fafc',
        };

        const grid = new SciGrid(container, provider, {
            rowHeight: 30,
            columnWidth: 120,
            showRowNumbers: true,
            rowNumbersWidth: 60,
            cellPadding: 12,
            ...darkConfig
        });

        const themeBtn = document.getElementById('theme-btn');
        let isDark = true;

        themeBtn.addEventListener('click', () => {
            isDark = !isDark;
            if (isDark) {
                grid.updateConfig(darkConfig);
                document.body.style.background = '#0a0a0b';
                themeBtn.textContent = 'Switch to Light Mode';
            } else {
                grid.updateConfig(lightConfig);
                document.body.style.background = '#ffffff';
                themeBtn.textContent = 'Switch to Dark Mode';
            }
        });
    </script>
</body>

</html>